# React Native pods 스크립트 로드
require_relative '../node_modules/react-native/scripts/react_native_pods'

# 최소 iOS 버전
platform :ios, '15.6'

prepare_react_native_project!

# Static linkage 사용 (Firebase, Kakao, Naver SDK 호환성)
use_frameworks! :linkage => :static

target 'CreditTalk' do
  # auto-link 설정 호출
  config = use_native_modules!

  # Naver 로그인 SDK
  pod 'NidThirdPartyLogin'

  # React Native Vector Icons - 폰트는 프로젝트에 이미 포함되어 있음 (Info.plist UIAppFonts)
  # auto-link를 통해 자동으로 연결됨

  # React Native core pods 설치
  use_react_native!(
    :path => config[:reactNativePath],
    :hermes_enabled => false
  )
end

post_install do |installer|
  # React Native 후처리 스크립트
  react_native_post_install(installer)

  # 모든 Pod 타겟에 대해 설정
  installer.pods_project.targets.each do |target|
    target.build_configurations.each do |config|
      # 빌드 설정 최적화
      config.build_settings['BUILD_LIBRARY_FOR_DISTRIBUTION'] = 'YES'
      config.build_settings['IPHONEOS_DEPLOYMENT_TARGET'] = '15.6'
    end
  end

  # CreditTalk 타겟에 React Native 헤더 경로 추가
  installer.pods_project.build_configurations.each do |config|
    config.build_settings['HEADER_SEARCH_PATHS'] ||= '$(inherited)'
    config.build_settings['HEADER_SEARCH_PATHS'] << ' "${PODS_ROOT}/../../node_modules/react-native/React"'
    config.build_settings['HEADER_SEARCH_PATHS'] << ' "${PODS_ROOT}/../../node_modules/react-native/Libraries"'
  end
end
